---
title: "React Router v6 ã‹ã‚‰ Tanstack Router v1ã«ç§»è¡Œã—ã¦æ„Ÿã˜ãŸãƒ¡ãƒªãƒƒãƒˆ"
emoji: "ğŸ™†"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["react", "typescript", "tanstackrouter", "reactrouter"]
published: false
---

ä½œæˆæ—¥æ™‚: 2025-11-07

## ã¯ã˜ã‚ã«

React Routerã¯é•·ã‚‰ãReactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ãŠã‘ã‚‹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã®ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ã§ã—ãŸãŒã€æœ€è¿‘ã§ã¯[TanStack Router](https://tanstack.com/router)ã¨ã„ã†æ–°ã—ã„é¸æŠè‚¢ãŒç™»å ´ã—ã¦ã„ã¾ã™ã€‚

TanStack Routerã¯ã€å‹å®‰å…¨æ€§ã‚’é‡è¦–ã—ãŸæ¬¡ä¸–ä»£ã®Reactãƒ«ãƒ¼ã‚¿ãƒ¼ã§ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã€è‡ªå‹•ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã€å®Œå…¨ãªå‹æ¨è«–ãªã©ã€ãƒ¢ãƒ€ãƒ³ãªReactã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³é–‹ç™ºã«å¿…è¦ãªæ©Ÿèƒ½ã‚’æä¾›ã—ã¦ã„ã¾ã™ã€‚

ã“ã®è¨˜äº‹ã§ã¯ã€å®Ÿéš›ã«React Router v6ã‹ã‚‰TanStack Router v1ã¸ç§»è¡Œã—ãŸéš›ã«æ„Ÿã˜ãŸãƒ¡ãƒªãƒƒãƒˆã«ã¤ã„ã¦ã€å…·ä½“çš„ãªã‚³ãƒ¼ãƒ‰ä¾‹ã¨ã¨ã‚‚ã«ç´¹ä»‹ã—ã¾ã™ã€‚

## Automatic Code Splitting

TanStack Routerã¯ã€ãƒ«ãƒ¼ãƒˆå˜ä½ã§ã®è‡ªå‹•ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚React Routerã§ã‚³ãƒ¼ãƒ‰åˆ†å‰²ã‚’å®Ÿç¾ã™ã‚‹ã«ã¯ã€`React.lazy`ã¨`Suspense`ã‚’æ‰‹å‹•ã§è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸãŒã€TanStack Routerã§ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã«è¨˜è¿°ã™ã‚‹ã ã‘ã§è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚

### React Router v6ã®å ´åˆ

```typescript
const Home = React.lazy(() => import('./pages/Home'));
const About = React.lazy(() => import('./pages/About'));

function App() {
  return (
    <Suspense fallback={<div>Loading...</div>}>
      <Routes>
        <Route path="/" element={<Home />} />
        <Route path="/about" element={<About />} />
      </Routes>
    </Suspense>
  );
}
```

### TanStack Router v1ã®å ´åˆ

```typescript
// routeTree.gen.ts (è‡ªå‹•ç”Ÿæˆ)
export const routeTree = rootRoute.addChildren([
  indexRoute,
  aboutRoute,
])

// vite.config.ts
export default defineConfig({
  plugins: [
    TanStackRouterVite({
      autoCodeSplitting: true, // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§true
    }),
  ],
})
```

ã“ã®è¨­å®šã«ã‚ˆã‚Šã€å„ãƒ«ãƒ¼ãƒˆã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒè‡ªå‹•çš„ã«åˆ†å‰²ã•ã‚Œã€å¿…è¦ã«ãªã£ãŸã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§èª­ã¿è¾¼ã¾ã‚Œã¾ã™ã€‚

## File-Based Routing

TanStack Routerã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ã‚’æ¡ç”¨ã—ã¦ãŠã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹é€ ãŒãã®ã¾ã¾ãƒ«ãƒ¼ãƒˆæ§‹é€ ã«ãªã‚Šã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ«ãƒ¼ãƒˆå®šç¾©ãŒç›´æ„Ÿçš„ã§ã€ç®¡ç†ã—ã‚„ã™ããªã‚Šã¾ã™ã€‚

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ ã®ä¾‹

```
src/routes/
â”œâ”€â”€ __root.tsx           # ãƒ«ãƒ¼ãƒˆãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ
â”œâ”€â”€ index.tsx            # / ãƒ‘ã‚¹
â”œâ”€â”€ about.tsx            # /about ãƒ‘ã‚¹
â”œâ”€â”€ posts/
â”‚   â”œâ”€â”€ index.tsx        # /posts ãƒ‘ã‚¹
â”‚   â””â”€â”€ $postId.tsx      # /posts/:postId ãƒ‘ã‚¹
â””â”€â”€ users/
    â””â”€â”€ $userId/
        â””â”€â”€ profile.tsx  # /users/:userId/profile ãƒ‘ã‚¹
```

### React Router v6ã®å ´åˆ

React Routerã§ã¯ã€ãƒ«ãƒ¼ãƒˆå®šç¾©ã‚’ã‚³ãƒ¼ãƒ‰ã§æ˜ç¤ºçš„ã«è¨˜è¿°ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```typescript
<Routes>
  <Route path="/" element={<Root />}>
    <Route index element={<Home />} />
    <Route path="about" element={<About />} />
    <Route path="posts" element={<Posts />} />
    <Route path="posts/:postId" element={<Post />} />
    <Route path="users/:userId/profile" element={<UserProfile />} />
  </Route>
</Routes>
```

### TanStack Router v1ã®å ´åˆ

TanStack Routerã§ã¯ã€ãƒ•ã‚¡ã‚¤ãƒ«ã‚·ã‚¹ãƒ†ãƒ ã®æ§‹é€ ã‹ã‚‰è‡ªå‹•çš„ã«ãƒ«ãƒ¼ãƒˆå®šç¾©ãŒç”Ÿæˆã•ã‚Œã¾ã™ã€‚CLIãƒ„ãƒ¼ãƒ«ã‚’ä½¿ã£ã¦ã€å‹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã‚‚è‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã€å¸¸ã«æœ€æ–°ã®ãƒ«ãƒ¼ãƒˆæƒ…å ±ãŒå‹ã¨ã—ã¦åˆ©ç”¨ã§ãã¾ã™ã€‚

```bash
# ãƒ«ãƒ¼ãƒˆå®šç¾©ã‚’è‡ªå‹•ç”Ÿæˆ
pnpm exec tsr generate
```

ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ«ãƒ¼ãƒˆè¿½åŠ æ™‚ã®è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ã®æ›´æ–°ãŒä¸è¦ã«ãªã‚Šã€ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ã‚’è¦‹ã‚‹ã ã‘ã§ãƒ«ãƒ¼ãƒˆæ§‹é€ ãŒæŠŠæ¡ã§ãã¾ã™ã€‚

## routeã®å‹ä»˜ã‘

### Pathã®å‹ä»˜ã‘

TanStack Routerã§ã¯ã€ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã«å¯¾ã—ã¦å®Œå…¨ãªå‹æ¨è«–ãŒåŠ¹ãã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€å­˜åœ¨ã—ãªã„ãƒ‘ã‚¹ã¸ã®ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«æ¤œå‡ºã§ãã¾ã™ã€‚

#### React Router v6ã®å ´åˆ

```typescript
import { useNavigate } from 'react-router-dom';

function MyComponent() {
  const navigate = useNavigate();

  // ã‚¿ã‚¤ãƒã—ã¦ã‚‚æ°—ã¥ã‘ãªã„
  navigate('/posst/123'); // ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„
}
```

#### TanStack Router v1ã®å ´åˆ

```typescript
import { useNavigate } from '@tanstack/react-router';

function MyComponent() {
  const navigate = useNavigate();

  // ã‚¿ã‚¤ãƒã™ã‚‹ã¨ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼
  navigate({ to: '/posst/$postId', params: { postId: '123' } }); // ã‚¨ãƒ©ãƒ¼: '/posst/$postId' ã¯å­˜åœ¨ã—ã¾ã›ã‚“

  // æ­£ã—ã„ãƒ‘ã‚¹ã®ã¿è¨±å¯ã•ã‚Œã‚‹
  navigate({ to: '/posts/$postId', params: { postId: '123' } }); // OK
}
```

è‡ªå‹•ç”Ÿæˆã•ã‚ŒãŸå‹å®šç¾©ã«ã‚ˆã‚Šã€å­˜åœ¨ã™ã‚‹ãƒ«ãƒ¼ãƒˆãƒ‘ã‚¹ã®ã¿ãŒè£œå®Œã•ã‚Œã€ã‚¿ã‚¤ãƒã‚„å­˜åœ¨ã—ãªã„ãƒ‘ã‚¹ã¸ã®é·ç§»ã‚’é˜²ã’ã¾ã™ã€‚

### Path paramsã®å‹ä»˜ã‘

ã‚ã‚‹URL(`/posts/:postId`)ãŒã‚ã£ãŸæ™‚ã«ã€`:postId`ã‚’å–å¾—ã™ã‚‹ã®ã«React Routerã§ã¯

```typescript
const { postId } = useParams();
```

ã¨æ›¸ãã¾ã™ãŒã€ã“ã®ã¨ã`postId`ã¯`string | undefined`ã¨ãªã‚Šã€ã¾ãŸå‹ä»˜ã‘ã‚‚ã•ã‚Œã¦ãªã„ã®ã§è£œå®ŒãŒåŠ¹ãã¾ã›ã‚“ã€‚

Tanstack Routerã®å ´åˆã¯ã€

```typescript
export const Route = createFileRoute('/posts/$postId/')({
  component: Post
}) // è‡ªå‹•ç”Ÿæˆ

function Post() {
  const { postId } = Route.useParams();
}
```

ã¨æ›¸ã‘ã¦ã€ã“ã®ã¨ã`postId`ã¯`string`ã«ãªã‚Šã¾ã™ã€‚ã¾ãŸ[zod](https://zod.dev/)ã‚’åˆ©ç”¨ã™ã‚‹ã¨ã€`postId`ã‚’`number`ã§validateã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

```typescript
export const Route = createFileRoute('/posts/$postId/')({
  component: Post,
  params: {
    parse: (params) => ({ postId: z.coerce.number().parse(params.postId) }),
  },
})

function Post() {
  const { postId } = Route.useParams();
}
```

ã“ã®æ™‚ã€`postId`ã¯`number`å‹ã¨ãªã‚Šã€ãƒ‘ãƒ¼ã‚¹ã«å¤±æ•—ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ãŒthrowã•ã‚Œã¾ã™ã€‚

### Search paramsã®å‹ä»˜ã‘

ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ï¼ˆSearch paramsï¼‰ã«ã¤ã„ã¦ã‚‚ã€TanStack Routerã§ã¯å®Œå…¨ãªå‹å®‰å…¨æ€§ãŒæä¾›ã•ã‚Œã¾ã™ã€‚

#### React Router v6ã®å ´åˆ

```typescript
import { useSearchParams } from 'react-router-dom';

function PostList() {
  const [searchParams] = useSearchParams();

  // å‹ãŒä»˜ã„ã¦ã„ãªã„ãŸã‚ã€è£œå®ŒãŒåŠ¹ã‹ãªã„
  const page = searchParams.get('page'); // string | null
  const sort = searchParams.get('sort'); // string | null
}
```

#### TanStack Router v1ã®å ´åˆ

```typescript
import { z } from 'zod';

export const Route = createFileRoute('/posts/')({
  component: PostList,
  validateSearch: z.object({
    page: z.number().optional().default(1),
    sort: z.enum(['asc', 'desc']).optional().default('desc'),
  }),
})

function PostList() {
  const { page, sort } = Route.useSearch();
  // page: number
  // sort: 'asc' | 'desc'
}
```

zodã‚¹ã‚­ãƒ¼ãƒã‚’ä½¿ã£ã¦ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã¨å‹å®šç¾©ã‚’åŒæ™‚ã«è¡Œãˆã‚‹ãŸã‚ã€ä¸æ­£ãªã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’é˜²ãã¤ã¤ã€å‹å®‰å…¨ãªã‚³ãƒ¼ãƒ‰ãŒæ›¸ã‘ã¾ã™ã€‚ã¾ãŸã€ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚‚è¨­å®šã§ãã‚‹ãŸã‚ã€`undefined`ãƒã‚§ãƒƒã‚¯ãŒä¸è¦ã«ãªã‚Šã¾ã™ã€‚

## URLä½œæˆã®ç°¡ç•¥åŒ–

TanStack Routerã§ã¯ã€URLã‚’æ–‡å­—åˆ—ã¨ã—ã¦çµ„ã¿ç«‹ã¦ã‚‹å¿…è¦ãŒãªãã€ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼ã§å‹å®‰å…¨ã«URLã‚’æ§‹ç¯‰ã§ãã¾ã™ã€‚

### React Router v6ã®å ´åˆ

```typescript
import { Link } from 'react-router-dom';

function PostCard({ postId }: { postId: number }) {
  // æ–‡å­—åˆ—ã¨ã—ã¦çµ„ã¿ç«‹ã¦ã‚‹å¿…è¦ãŒã‚ã‚‹
  return (
    <Link to={`/posts/${postId}?sort=desc&page=1`}>
      View Post
    </Link>
  );
}
```

### TanStack Router v1ã®å ´åˆ

```typescript
import { Link } from '@tanstack/react-router';

function PostCard({ postId }: { postId: number }) {
  // ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼ã§å‹å®‰å…¨ã«è¨˜è¿°
  return (
    <Link
      to="/posts/$postId"
      params={{ postId }}
      search={{ sort: 'desc', page: 1 }}
    >
      View Post
    </Link>
  );
}
```

ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ãŒæ˜ç¢ºã«åˆ†é›¢ã•ã‚Œã€å‹ãƒã‚§ãƒƒã‚¯ã‚‚åŠ¹ããŸã‚ã€ã‚¿ã‚¤ãƒã‚„ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ¸¡ã—å¿˜ã‚Œã‚’é˜²ã’ã¾ã™ã€‚ã¾ãŸã€URLã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ãªã©ã‚‚è‡ªå‹•çš„ã«å‡¦ç†ã•ã‚Œã¾ã™ã€‚

## beforeLoad

TanStack Routerã«ã¯ã€ãƒ«ãƒ¼ãƒˆã®èª­ã¿è¾¼ã¿å‰ã«å®Ÿè¡Œã•ã‚Œã‚‹`beforeLoad`ãƒ•ãƒƒã‚¯ãŒã‚ã‚Šã¾ã™ã€‚ã“ã‚Œã‚’ä½¿ã†ã¨ã€èªè¨¼ãƒã‚§ãƒƒã‚¯ã‚„ãƒ‡ãƒ¼ã‚¿ã®äº‹å‰èª­ã¿è¾¼ã¿ãªã©ã‚’å‹å®‰å…¨ã«å®Ÿè£…ã§ãã¾ã™ã€‚

### èªè¨¼ãƒã‚§ãƒƒã‚¯ã®ä¾‹

```typescript
export const Route = createFileRoute('/dashboard/')({
  component: Dashboard,
  beforeLoad: async ({ context }) => {
    // èªè¨¼ãƒã‚§ãƒƒã‚¯
    if (!context.auth.isAuthenticated) {
      throw redirect({ to: '/login' });
    }
  },
})
```

### ãƒ‡ãƒ¼ã‚¿ã®äº‹å‰èª­ã¿è¾¼ã¿

```typescript
export const Route = createFileRoute('/posts/$postId/')({
  component: Post,
  beforeLoad: async ({ params }) => {
    const post = await fetchPost(params.postId);
    return { post };
  },
})

function Post() {
  const { post } = Route.useRouteContext();
  // post ã®ãƒ‡ãƒ¼ã‚¿ãŒä¿è¨¼ã•ã‚Œã¦ã„ã‚‹
}
```

React Routerã®`loader`ã«ä¼¼ãŸæ©Ÿèƒ½ã§ã™ãŒã€TanStack Routerã§ã¯å‹æ¨è«–ãŒåŠ¹ããŸã‚ã€è¿”ã‚Šå€¤ã®å‹ãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆå´ã§è‡ªå‹•çš„ã«æ¨è«–ã•ã‚Œã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ãƒ‡ãƒ¼ã‚¿ã®å­˜åœ¨ãŒä¿è¨¼ã•ã‚Œã€å®‰å…¨ã«ãƒ‡ãƒ¼ã‚¿ã‚’æ‰±ãˆã¾ã™ã€‚

## ã¾ã¨ã‚

React Router v6ã‹ã‚‰TanStack Router v1ã¸ã®ç§»è¡Œã§æ„Ÿã˜ãŸä¸»ãªãƒ¡ãƒªãƒƒãƒˆã‚’ã¾ã¨ã‚ã¾ã™ã€‚

### å‹å®‰å…¨æ€§ã®å¤§å¹…ãªå‘ä¸Š

- **ãƒ‘ã‚¹ã®å‹ãƒã‚§ãƒƒã‚¯**: å­˜åœ¨ã—ãªã„ãƒ«ãƒ¼ãƒˆã¸ã®é·ç§»ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ™‚ã«æ¤œå‡º
- **ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®å‹æ¨è«–**: Path paramsã¨Search paramsãŒå®Œå…¨ã«å‹ä»˜ã‘ã•ã‚Œã‚‹
- **ãƒ‡ãƒ¼ã‚¿ã®å‹ä¿è¨¼**: `beforeLoad`ã®è¿”ã‚Šå€¤ãŒã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã§è‡ªå‹•æ¨è«–ã•ã‚Œã‚‹

### é–‹ç™ºä½“é¨“ã®æ”¹å–„

- **ãƒ•ã‚¡ã‚¤ãƒ«ãƒ™ãƒ¼ã‚¹ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚°**: ãƒ•ã‚¡ã‚¤ãƒ«æ§‹é€ ãŒãã®ã¾ã¾ãƒ«ãƒ¼ãƒˆæ§‹é€ ã«ãªã‚Šã€ç›´æ„Ÿçš„
- **è‡ªå‹•ã‚³ãƒ¼ãƒ‰åˆ†å‰²**: è¨­å®šä¸è¦ã§å„ãƒ«ãƒ¼ãƒˆãŒè‡ªå‹•çš„ã«åˆ†å‰²ã•ã‚Œã‚‹
- **URLæ§‹ç¯‰ã®ç°¡ç•¥åŒ–**: ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆå½¢å¼ã§å‹å®‰å…¨ã«URLã‚’ä½œæˆã§ãã‚‹

### TypeScriptã¨ã®è¦ªå’Œæ€§

TanStack Routerã¯ã€TypeScriptãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã§è¨­è¨ˆã•ã‚Œã¦ãŠã‚Šã€å‹æ¨è«–ãŒéå¸¸ã«å¼·åŠ›ã§ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€ã‚³ãƒ¼ãƒ‰è£œå®ŒãŒåŠ¹ãã‚„ã™ãã€ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚‚å®‰å…¨ã«è¡Œãˆã¾ã™ã€‚

React Routerã‚‚å„ªã‚ŒãŸãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã™ãŒã€TypeScriptã‚’ä½¿ã£ãŸãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å‹å®‰å…¨æ€§ã‚’é‡è¦–ã™ã‚‹ãªã‚‰ã€TanStack Routerã¸ã®ç§»è¡Œã‚’æ¤œè¨ã™ã‚‹ä¾¡å€¤ã¯ååˆ†ã«ã‚ã‚‹ã¨æ€ã„ã¾ã™ã€‚
